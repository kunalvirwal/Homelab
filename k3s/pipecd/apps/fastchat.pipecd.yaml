apiVersion: pipecd.dev/v1beta1
kind: KubernetesApp
spec:
  name: fastchat
  eventWatcher:
    - matcher:
        name: fastchat-image-update
      handler:
        type: GIT_UPDATE
        config:
          replacements:
            - file: ../../apps/fastchat/deployment.yaml
              yamlField: $.spec.template.spec.containers[0].image
  input:
    manifests:
      - ../../apps/fastchat/deployment.yaml
      - ../../apps/fastchat/service.yaml
      - ../../apps/fastchat/ingress.yaml
    kubectlVersion: 1.32.5
  trigger:
    onOutOfSync:
      disabled: false
      minWindow: 0m
  encryption:
    encryptedSecrets: # These secrets are key encrypted and safe to push to github for running pipecd but still it is a better practice to keep the repo private
      SECRET_KEY: AgB0lyhIgxLhNXr8wao/G/UzLuEtQxCg6RxipMUhItP+tJMKjdmudHVvkfNWyuPiO4+hiHZzduz0AUIvSTfQUFHPxEsIlBjKbQg9xhGPWDs6JrFvuP1jCUW9xxtitLabMf6UgUZHA/jonn2B7KvVWdzDQhNBZtL6QIfUBkhC7soIsQoDJVuWE1r0s01HtpzrJZkUT83xSuoNIrJfcS4oOzcgSu3e0FKgEalcZQzlLKDxCIeclBrR+VPP9IYcJ9B0cys8ucEyua++8n/p4PCwQvp5Fh+d4odgz3hADR/jutOZcMDYXUc9r4PLkBpf2Vhw+TiJKdacxzFJznSZcLH7q46FXqQeuaC+kJn1eihuQBcg+tm8z0M+VTDoJJqTRHNzMC4ssbb5OC097+aA4IyPzYSPCAzgycKR/0Z9IIwF7WxLpKrp/YkM76QEAH/QEv/6BBa6KjnhXFvWX6InagaEq4P+3pp6+yCjFDt++IpDdvnsZSJWM6O+O3Ci0jbgZxJQD4BI4BoEPTd3kSQBdr62smiHf9DEHrv2QB6Vxv4BMeMhmm/LDwaCRvMD9wdUEG1I5Cfa1ogMRdEwOZQMi7vwVeh4X5bgH/HtSQFGPq94N9xvL0T+rawoWhk2BMUJsrPA5F+y7NoGwi4SqTBK3Q79u7Nu1IPVWiTVjv8fgdg5SVi+yCCxypMivHW1X04DM9xyrzB2CeMrfJFj8xg=
      MONGODB_URI: AgAdJAa06ePAiVa2fZwnko7pGPXUUhxbHLB9qSBvUGCI0k+PQjhd5CTfYTWjnc5yOodkj4YWAtFPEAEFGAfnJXna+cPe2dhAXXONawRcc7WsKS3txhUYNlLEST8nOfcqVOBREB6twik37sCtMwmo0vhGIvCQb73mEevKn4O9bG23Bj/TMoFgxYsjXswrrWWu2MCN1nYfaIeDOj+ZHyYbuWNitPuVPAFmuc+jNZ4vjR6mX+IRstyZNlb9Txu+rlvDhlQNjvaZHkQ/QK7fUgpfEGdTVy/w7DvAe7aA56LtTYuD1k1f/uRszBf7K0R8SxXJB2ujey8rIu56U2mmLVwp4EvfqBLJNYdGvkCm84BdGifLGL3lUd10EgmF5GyVj0EuGxXhSBRIRXLeHe3+rZpEmDpU/7Rjt9k5/Rlok8g2V/Qd22Ogu3UvrAHd1rs6lS4luDHtofnD6Av6lT2paifgmwQq2BfdBYmf37/u1NIgipsjfqAHMopJj16n2DjM0rl9DcoERSAJ7qFfNgjNjH2QVQ12T+JS8nJVTWrnsJfBTmPe9Qr6cyZqJsVB6wHW18fbg82AaliHVDOSGkm2s3y+stSRNJiaurE4migmJub36tvRMoKwiSiA+PGzr/n7xd2YJUJtyjGxthwVbOPDTqTubwPLyx0wTag7mPeYDgZlF+EKMG41BTOwIPaaMWSNRdHVN9QgQ3GQui9WfSLLHGNOXXehejgv+kwT8j7B4ytYbb2SbfN+8WiqEWtSKNfVvsSqqo4WO7WklQzTVI4AB0oCG3x3OVcmljUGx7rdEsoZ90Xj7Xn0odCW41F926ml7UsO8rZpEXPD
    decryptionTargets:
      - ../../apps/fastchat/deployment.yaml

  description: |
    This app is a self made chat server that uses websockets under the hood.
